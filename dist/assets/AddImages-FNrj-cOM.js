import{r as h,y as u,l as M,u as k,j as s,a as _,b as O,x as i,S as N}from"./index-Cs-9O0Ij.js";import{u as I,G as S}from"./index-Dtpw7axR.js";/* empty css                  */var D={},m={};Object.defineProperty(m,"__esModule",{value:!0});m.cssValue=m.parseLengthAndUnit=void 0;var L={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function A(e){if(typeof e=="number")return{value:e,unit:"px"};var r,o=(e.match(/^[0-9.]*/)||"").toString();o.includes(".")?r=parseFloat(o):r=parseInt(o,10);var a=(e.match(/[^0-9]*$/)||"").toString();return L[a]?{value:r,unit:a}:(console.warn("React Spinners: ".concat(e," is not a valid css value. Defaulting to ").concat(r,"px.")),{value:r,unit:"px"})}m.parseLengthAndUnit=A;function R(e){var r=A(e);return"".concat(r.value).concat(r.unit)}m.cssValue=R;var y={};Object.defineProperty(y,"__esModule",{value:!0});y.createAnimation=void 0;var T=function(e,r,o){var a="react-spinners-".concat(e,"-").concat(o);if(typeof window>"u"||!window.document)return a;var n=document.createElement("style");document.head.appendChild(n);var p=n.sheet,d=`
    @keyframes `.concat(a,` {
      `).concat(r,`
    }
  `);return p&&p.insertRule(d,0),a};y.createAnimation=T;var x=u&&u.__assign||function(){return x=Object.assign||function(e){for(var r,o=1,a=arguments.length;o<a;o++){r=arguments[o];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},x.apply(this,arguments)},$=u&&u.__createBinding||(Object.create?function(e,r,o,a){a===void 0&&(a=o);var n=Object.getOwnPropertyDescriptor(r,o);(!n||("get"in n?!r.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return r[o]}}),Object.defineProperty(e,a,n)}:function(e,r,o,a){a===void 0&&(a=o),e[a]=r[o]}),F=u&&u.__setModuleDefault||(Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r}),z=u&&u.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(e!=null)for(var o in e)o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)&&$(r,e,o);return F(r,e),r},J=u&&u.__rest||function(e,r){var o={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&r.indexOf(a)<0&&(o[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)r.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(o[a[n]]=e[a[n]]);return o};Object.defineProperty(D,"__esModule",{value:!0});var V=z(h),B=m,q=y,G=(0,q.createAnimation)("ClipLoader","0% {transform: rotate(0deg) scale(1)} 50% {transform: rotate(180deg) scale(0.8)} 100% {transform: rotate(360deg) scale(1)}","clip");function W(e){var r=e.loading,o=r===void 0?!0:r,a=e.color,n=a===void 0?"#000000":a,p=e.speedMultiplier,d=p===void 0?1:p,f=e.cssOverride,j=f===void 0?{}:f,v=e.size,b=v===void 0?35:v,w=J(e,["loading","color","speedMultiplier","cssOverride","size"]),C=x({background:"transparent !important",width:(0,B.cssValue)(b),height:(0,B.cssValue)(b),borderRadius:"100%",border:"2px solid",borderTopColor:n,borderBottomColor:"transparent",borderLeftColor:n,borderRightColor:n,display:"inline-block",animation:"".concat(G," ").concat(.75/d,"s 0s infinite linear"),animationFillMode:"both"},j);return o?V.createElement("span",x({style:C},w)):null}var Y=D.default=W;const X=()=>{const[e,r]=h.useState([]),[o,a]=h.useState(!1),[n,p]=h.useState({}),{id:d}=M(),f=k(),j=c=>{if(e.length+c.length>5){i.error("You can upload a maximum of 5 images.");return}const l=c.filter(t=>t.type.startsWith("image/"));if(l.length===0){i.error("Only image files are allowed.");return}r(t=>[...t,...l])},v=c=>{r(l=>l.filter((t,g)=>g!==c))},{getRootProps:b,getInputProps:w}=I({onDrop:j,accept:{"image/*":[]}}),C=async()=>{var c,l;try{const t=await _.get(`${O}/jobcard/${d}`);if(t.status===200){if(((c=t.data)==null?void 0:c.data)===null){f("/admin/add-jobcard");return}p((l=t==null?void 0:t.data)==null?void 0:l.data)}}catch(t){f("/admin/add-jobcard"),i.error("Error occurred, refresh the page"),console.error(t)}},U=async()=>{var l;if(!(await N.fire({title:"Are you sure?",text:"Do you want to skip the upload part?",icon:"info",showCancelButton:!0,confirmButtonColor:"#3890d8",cancelButtonColor:"#d65f63",confirmButtonText:"Skip",cancelButtonText:"Cancel",background:"#1e1f20",color:"#ffffff",customClass:{popup:"custom-popup",confirmButton:"custom-confirm-button",cancelButton:"custom-cancel-button"}})).isConfirmed){i.info("Upload canceled.");return}try{const t=await _.post(`${O}/jobcard/skip/${d}`);if(t.status===200&&t.data.success)i.success("Skipped successfully!"),setTimeout(()=>{f("/admin/pending")},1e3);else throw new Error(((l=t.data)==null?void 0:l.message)||"Failed to upload images.")}catch(t){console.log(t),console.error("Upload error:",t),t.response?t.response.status===400?i.error(t.response.data.message||"Invalid request. Please try again."):t.response.status===404?i.error("Job card not found. Please verify the job card ID."):t.response.status===500?i.error("Server error. Please try again later."):i.error("Unexpected error. Please try again."):t.request?i.error("Network error. Check your connection."):i.error(t.message||"An error occurred.")}},E=async()=>{var l;if(e.length===0){i.error("Please select at least one image.");return}if(!(await N.fire({title:"Are you sure?",text:"Do you want to upload the selected images?",icon:"info",showCancelButton:!0,confirmButtonColor:"#3890d8",cancelButtonColor:"#d65f63",confirmButtonText:"Yes, upload!",cancelButtonText:"Cancel",background:"#1e1f20",color:"#ffffff",customClass:{popup:"custom-popup",confirmButton:"custom-confirm-button",cancelButton:"custom-cancel-button"}})).isConfirmed){i.info("Upload canceled.");return}a(!0);try{const t=new FormData;e.forEach(P=>{if(P.size>5*1024*1024)throw new Error("One or more files exceed the 5MB size limit.");t.append("images",P)});const g=await _.post(`${O}/jobcard/upload/${d}`,t,{headers:{"Content-Type":"multipart/form-data"}});if(g.status===200&&g.data.success)i.success("Images Appended successfully!"),setTimeout(()=>{f("/admin/pending")},1e3);else throw new Error(((l=g.data)==null?void 0:l.message)||"Failed to upload images.")}catch(t){console.error("Upload error:",t),t.response?t.response.status===400?i.error(t.response.data.message||"Invalid request. Please try again."):t.response.status===404?i.error("Job card not found. Please verify the job card ID."):t.response.status===500?i.error("Server error. Please try again later."):i.error("Unexpected error. Please try again."):t.request?i.error("Network error. Check your connection."):i.error(t.message||"An error occurred.")}finally{a(!1)}};return h.useEffect(()=>{if(!d){f("/admin");return}C()},[d,f]),s.jsx("div",{className:"flex flex-col items-start w-full justify-start min-h-screen  px-4",children:s.jsxs("div",{className:"w-full  rounded-lg sm:p-8 p-1",children:[s.jsx("h1",{className:"text-3xl font-bold mb-2 text-white",children:"Append image"}),s.jsx("p",{className:"text-white mb-6",children:"Hi-Tech Engineering company"}),s.jsxs("div",{className:" border-dashed border border-white lg:p-10 p-4 sm:p-6 md:p-8 rounded-lg relative",children:[s.jsxs("p",{className:"text-white text-2xl",children:[s.jsx("b",{children:"Job Card Number:"})," ",n.jobCardNumber]}),s.jsx("div",{className:"flex flex-col border border-dashed border-white px-8 py-10 rounded-lg lg:flex-row gap-8",children:s.jsxs("div",{...b(),className:" p-6 rounded-lg cursor-pointer  transition w-full",children:[s.jsx("input",{...w()}),e.length===0?s.jsx("p",{className:"text-gray-500 text-center",children:"Drag & drop images here, or click to select"}):s.jsx("div",{className:"grid grid-cols-3 gap-4",children:e.map((c,l)=>s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:URL.createObjectURL(c),alt:`uploaded-${l}`,className:"w-full h-60 object-cover rounded"}),s.jsx("button",{onClick:t=>{t.stopPropagation(),v(l)},className:"absolute top-2 right-2 bg-[#d65f63] rounded-full w-fit text-white text-center flex justify-center items-center transition rotate-45",children:s.jsx(S,{size:20,color:"white"})})]},l))}),e.length<5&&s.jsx("div",{className:"w-full flex justify-center items-center pt-3",children:s.jsx("div",{className:"bg-[#d65f63] rounded-full w-fit text-white text-center flex justify-center items-center",children:s.jsx(S,{size:20,color:"white"})})})]})}),s.jsxs("div",{className:"flex items-center lg:justify-end justify-center space-x-4 mt-6",children:[s.jsx("button",{type:"button",className:"sm:px-12 px-8 py-1 sm:py-2 border border-[#d65f63] rounded-lg text-[#d65f63] font-medium hover:bg-[#d65f63] transition duration-300 hover:text-white",onClick:U,children:"Skip"}),s.jsx("button",{type:"submit",onClick:c=>E(),className:"sm:px-12 px-8 py-1 sm:py-2 bg-[#d65f63] hover:bg-[#3890d8] transition duration-300 text-white rounded-lg ",disabled:o||e.length===0,children:o?s.jsx(Y,{color:"#ffffff",size:20}):"Append"})]})]})]})})};export{X as default};
