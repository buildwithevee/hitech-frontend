import{r as v,y as d,z as I,l as L,u as R,j as s,a as _,b as O,x as i,S as P}from"./index-Bru2VB64.js";import{u as T,G as S}from"./index-CU7T5RAq.js";/* empty css                  */var D={},g={};Object.defineProperty(g,"__esModule",{value:!0});g.cssValue=g.parseLengthAndUnit=void 0;var $={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function A(e){if(typeof e=="number")return{value:e,unit:"px"};var r,a=(e.match(/^[0-9.]*/)||"").toString();a.includes(".")?r=parseFloat(a):r=parseInt(a,10);var o=(e.match(/[^0-9]*$/)||"").toString();return $[o]?{value:r,unit:o}:(console.warn("React Spinners: ".concat(e," is not a valid css value. Defaulting to ").concat(r,"px.")),{value:r,unit:"px"})}g.parseLengthAndUnit=A;function z(e){var r=A(e);return"".concat(r.value).concat(r.unit)}g.cssValue=z;var j={};Object.defineProperty(j,"__esModule",{value:!0});j.createAnimation=void 0;var F=function(e,r,a){var o="react-spinners-".concat(e,"-").concat(a);if(typeof window>"u"||!window.document)return o;var n=document.createElement("style");document.head.appendChild(n);var f=n.sheet,b=`
    @keyframes `.concat(o,` {
      `).concat(r,`
    }
  `);return f&&f.insertRule(b,0),o};j.createAnimation=F;var y=d&&d.__assign||function(){return y=Object.assign||function(e){for(var r,a=1,o=arguments.length;a<o;a++){r=arguments[a];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},y.apply(this,arguments)},J=d&&d.__createBinding||(Object.create?function(e,r,a,o){o===void 0&&(o=a);var n=Object.getOwnPropertyDescriptor(r,a);(!n||("get"in n?!r.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return r[a]}}),Object.defineProperty(e,o,n)}:function(e,r,a,o){o===void 0&&(o=a),e[o]=r[a]}),V=d&&d.__setModuleDefault||(Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r}),q=d&&d.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(e!=null)for(var a in e)a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)&&J(r,e,a);return V(r,e),r},G=d&&d.__rest||function(e,r){var a={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&r.indexOf(o)<0&&(a[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,o=Object.getOwnPropertySymbols(e);n<o.length;n++)r.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(a[o[n]]=e[o[n]]);return a};Object.defineProperty(D,"__esModule",{value:!0});var W=q(v),B=g,Y=j,H=(0,Y.createAnimation)("ClipLoader","0% {transform: rotate(0deg) scale(1)} 50% {transform: rotate(180deg) scale(0.8)} 100% {transform: rotate(360deg) scale(1)}","clip");function K(e){var r=e.loading,a=r===void 0?!0:r,o=e.color,n=o===void 0?"#000000":o,f=e.speedMultiplier,b=f===void 0?1:f,m=e.cssOverride,p=m===void 0?{}:m,u=e.size,x=u===void 0?35:u,w=G(e,["loading","color","speedMultiplier","cssOverride","size"]),C=y({background:"transparent !important",width:(0,B.cssValue)(x),height:(0,B.cssValue)(x),borderRadius:"100%",border:"2px solid",borderTopColor:n,borderBottomColor:"transparent",borderLeftColor:n,borderRightColor:n,display:"inline-block",animation:"".concat(H," ").concat(.75/b,"s 0s infinite linear"),animationFillMode:"both"},p);return a?W.createElement("span",y({style:C},w)):null}var Q=D.default=K;const te=()=>{const[e,r]=v.useState([]),[a,o]=v.useState(!1),[n,f]=v.useState({}),m=I().state,{id:p}=L(),u=R(),x=c=>{if(e.length+c.length>5){i.error("You can upload a maximum of 5 images.");return}const l=c.filter(t=>t.type.startsWith("image/"));if(l.length===0){i.error("Only image files are allowed.");return}r(t=>[...t,...l])},w=c=>{r(l=>l.filter((t,h)=>h!==c))},{getRootProps:C,getInputProps:U}=T({onDrop:x,accept:{"image/*":[]}}),E=async()=>{var c,l;try{const t=await _.get(`${O}/jobcard/${p}`);if(t.status===200){if(((c=t.data)==null?void 0:c.data)===null){u("/admin/add-jobcard");return}f((l=t==null?void 0:t.data)==null?void 0:l.data)}}catch(t){u("/admin/add-jobcard"),i.error("Error occurred, refresh the page"),console.error(t)}},k=async()=>{var l;if(!(await P.fire({title:"Are you sure?",text:"Do you want to skip the upload part?",icon:"info",showCancelButton:!0,confirmButtonColor:"#3890d8",cancelButtonColor:"#d65f63",confirmButtonText:"Skip",cancelButtonText:"Cancel",background:"#1e1f20",color:"#ffffff",customClass:{popup:"custom-popup",confirmButton:"custom-confirm-button",cancelButton:"custom-cancel-button"}})).isConfirmed){i.info("Upload canceled.");return}try{const t=await _.post(`${O}/jobcard/skip/${p}`);if(t.status===200&&t.data.success)i.success("Skipped successfully!"),setTimeout(()=>{u("/admin/pending")},1e3);else throw new Error(((l=t.data)==null?void 0:l.message)||"Failed to upload images.")}catch(t){console.log(t),console.error("Upload error:",t),t.response?t.response.status===400?i.error(t.response.data.message||"Invalid request. Please try again."):t.response.status===404?i.error("Job card not found. Please verify the job card ID."):t.response.status===500?i.error("Server error. Please try again later."):i.error("Unexpected error. Please try again."):t.request?i.error("Network error. Check your connection."):i.error(t.message||"An error occurred.")}},M=async()=>{var l;if(e.length===0){i.error("Please select at least one image.");return}if(!(await P.fire({title:"Are you sure?",text:"Do you want to upload the selected images?",icon:"info",showCancelButton:!0,confirmButtonColor:"#3890d8",cancelButtonColor:"#d65f63",confirmButtonText:"Yes, upload!",cancelButtonText:"Cancel",background:"#1e1f20",color:"#ffffff",customClass:{popup:"custom-popup",confirmButton:"custom-confirm-button",cancelButton:"custom-cancel-button"}})).isConfirmed){i.info("Upload canceled.");return}o(!0);try{const t=new FormData;e.forEach(N=>{if(N.size>5*1024*1024)throw new Error("One or more files exceed the 5MB size limit.");t.append("images",N)});const h=await _.post(`${O}/jobcard/upload/${p}`,t,{headers:{"Content-Type":"multipart/form-data"}});if(h.status===200&&h.data.success)i.success("Images Appended successfully!"),setTimeout(()=>{u("/admin/pending")},1e3);else throw new Error(((l=h.data)==null?void 0:l.message)||"Failed to upload images.")}catch(t){console.error("Upload error:",t),t.response?t.response.status===400?i.error(t.response.data.message||"Invalid request. Please try again."):t.response.status===404?i.error("Job card not found. Please verify the job card ID."):t.response.status===500?i.error("Server error. Please try again later."):i.error("Unexpected error. Please try again."):t.request?i.error("Network error. Check your connection."):i.error(t.message||"An error occurred.")}finally{o(!1)}};return v.useEffect(()=>{if(!p){u("/admin");return}E()},[p,u]),s.jsx("div",{className:"flex flex-col items-start w-full justify-start min-h-screen  px-4",children:s.jsxs("div",{className:"w-full  rounded-lg sm:p-8 p-1",children:[s.jsx("h1",{className:"text-3xl font-bold mb-2 text-white",children:"Append image"}),s.jsx("p",{className:"text-white mb-6",children:"Hi-Tech Engineering company"}),s.jsxs("div",{className:" border-dashed border border-white lg:p-10 p-4 sm:p-6 md:p-8 rounded-lg relative",children:[s.jsxs("p",{className:"text-white text-2xl",children:[s.jsx("b",{children:"Job Card Number:"})," ",n.jobCardNumber]}),s.jsx("div",{className:"flex flex-col border border-dashed border-white px-8 py-10 rounded-lg lg:flex-row gap-8",children:s.jsxs("div",{...C(),className:" p-6 rounded-lg cursor-pointer  transition w-full",children:[s.jsx("input",{...U()}),e.length===0?s.jsx("p",{className:"text-gray-500 text-center",children:"Drag & drop images here, or click to select"}):s.jsx("div",{className:"grid grid-cols-3 gap-4",children:e.map((c,l)=>s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:URL.createObjectURL(c),alt:`uploaded-${l}`,className:"w-full h-60 object-cover rounded"}),s.jsx("button",{onClick:t=>{t.stopPropagation(),w(l)},className:"absolute top-2 right-2 bg-[#d65f63] rounded-full w-fit text-white text-center flex justify-center items-center transition rotate-45",children:s.jsx(S,{size:20,color:"white"})})]},l))}),e.length<5&&s.jsx("div",{className:"w-full flex justify-center items-center pt-3",children:s.jsx("div",{className:"bg-[#d65f63] rounded-full w-fit text-white text-center flex justify-center items-center",children:s.jsx(S,{size:20,color:"white"})})})]})}),s.jsxs("div",{className:"flex items-center lg:justify-end justify-center space-x-4 mt-6",children:[(m==null?void 0:m.type)==="cancel"?s.jsx("div",{type:"button",className:"sm:px-12 px-8 py-1 sm:py-2 border border-[#d65f63] rounded-lg text-[#d65f63] font-medium hover:bg-[#d65f63] transition duration-300 hover:text-white",onClick:()=>u(-1),children:"Cancel"}):s.jsx("button",{type:"button",className:"sm:px-12 px-8 py-1 sm:py-2 border border-[#d65f63] rounded-lg text-[#d65f63] font-medium hover:bg-[#d65f63] transition duration-300 hover:text-white",onClick:k,children:"Skip"}),s.jsx("button",{type:"submit",onClick:c=>M(),className:"sm:px-12 px-8 py-1 sm:py-2 bg-[#d65f63] hover:bg-[#3890d8] transition duration-300 text-white rounded-lg ",disabled:a||e.length===0,children:a?s.jsx(Q,{color:"#ffffff",size:20}):"Append"})]})]})]})})};export{te as default};
