import{r as o,j as e,a as u,b as h,_ as s}from"./index-DQcph4hN.js";import{u as I,G as W}from"./index-Be9UmxmU.js";import{I as $}from"./index-BcJVJkuS.js";const U=()=>{const[N,w]=o.useState([]),[a,x]=o.useState(1),[i,j]=o.useState(0),[y,c]=o.useState(!1),[d,m]=o.useState(""),[n,p]=o.useState({workerName:"",phoneNumber:""}),k=t=>{const r=t[0];if(!r){s.error("No file selected.");return}if(!r.type.startsWith("image/")){s.error("Only image files are allowed.");return}if(r.size>5*1024*1024){s.error("File size exceeds the 5MB limit.");return}m(r)},v=()=>{m(null)},{getRootProps:P,getInputProps:C}=I({onDrop:k,accept:{"image/*":[]},multiple:!1}),b=t=>{t.preventDefault();const{name:r,value:l}=t.target;p(S=>({...S,[r]:l}))},g=async()=>{try{const t=await u.get(`${h}/worker?page=${a}&limit=5`);t.status===200&&(w(t.data.workers),j(t.data.totalPages))}catch(t){console.error("Error fetching job cards:",t)}},D=async t=>{try{(await u.post(`${h}/worker/change-status?id=${t}`)).status===200&&g()}catch(r){console.error("Error fetching job cards:",r)}},f=async t=>{if(t.preventDefault(),!d){s.error("Please upload an image.");return}if(!n.workerName||!n.phoneNumber){s.error("Worker name and phone number are required.");return}try{const r=new FormData;r.append("image",d),r.append("workerName",n.workerName.trim()),r.append("phoneNumber",n.phoneNumber.trim());const l=await u.post(`${h}/worker/new-worker`,r,{headers:{"Content-Type":"multipart/form-data"}});l.status===200&&l.data.success?s.success("Worker created successfully!"):s.error(l.data.message||"Unexpected error occurred. Please try again.")}catch(r){if(r.response)switch(r.response.status){case 400:s.error(r.response.data.message||"Invalid input. Please check your data.");break;case 401:s.error("Unauthorized. Please check your credentials.");break;case 500:s.error("Server error. Please try again later.");break;default:s.error(r.response.data.message||"An unexpected error occurred.")}else r.request?s.error("Network error. Please check your internet connection."):s.error(r.message||"An unknown error occurred.")}finally{m(""),p({phoneNumber:"",workerName:""}),c(!1)}};return o.useEffect(()=>{g()},[a,f]),e.jsx("div",{className:"min-h-screen w-full px-4 py-6 ",children:e.jsxs("div",{className:"flex flex-col items-start w-full max-w-7xl mx-auto relative",children:[e.jsx("h1",{className:"text-4xl font-bold text-white mb-4",children:"Workers"}),e.jsx("p",{className:"text-white mb-6",children:"Hi-Tech Engineering Company"}),e.jsx("button",{className:"px-5 py-2 bg-[#3890d8] text-white rounded-md absolute right-10 top-5 ",onClick:()=>c(t=>!t),children:"Add"}),y&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-[#1e1f20]   rounded-lg shadow-lg w-full max-w-md p-6 relative",children:[e.jsx("button",{onClick:()=>c(!1),className:"absolute top-3 right-3 text-gray-400 hover:text-gray-600",children:"âœ–"}),e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Enter Worker Details"}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{...P(),className:"p-6 rounded-lg cursor-pointer transition w-full border border-dashed border-white",children:[e.jsx("input",{...C()}),d?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:URL.createObjectURL(d),alt:"uploaded",className:"w-full h-60 object-cover rounded"}),e.jsx("button",{onClick:t=>{t.stopPropagation(),v()},className:"absolute top-2 right-2 bg-[#d65f63] rounded-full w-fit text-white text-center flex justify-center items-center transition rotate-45",children:e.jsx(W,{size:20,color:"white"})})]}):e.jsx("p",{className:"text-gray-500 text-center",children:"Drag & drop an image here, or click to select"})]}),";",e.jsxs("div",{children:[e.jsx("label",{htmlFor:"workerName",className:"block text-sm font-medium text-white",children:"Name"}),e.jsx("input",{type:"text",id:"workerName",name:"workerName",value:n.workerName,required:!0,onChange:b,className:"p-2 mt-1 block w-full rounded-lg border-gray-300 text-white bg-[#282a2c] shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phoneNumber",className:"block text-sm font-medium text-white",children:"Phone Number"}),e.jsx("input",{type:"text",id:"phoneNumber",name:"phoneNumber",value:n.phoneNumber,onChange:b,required:!0,className:"p-2 mt-1 block w-full rounded-lg border-gray-300 text-white bg-[#282a2c] shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 font-medium rounded-lg hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white font-medium rounded-lg shadow-md hover:bg-blue-700",children:"Submit"})]})]})]})}),e.jsxs("div",{className:"w-full bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsxs("table",{className:"min-w-full  border border-slate-600",children:[e.jsx("thead",{className:"bg-[#4a4d50] text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left font-medium",children:"Image"}),e.jsx("th",{className:"px-6 py-3 text-left font-medium",children:"Worker Name"}),e.jsx("th",{className:"px-6 py-3 text-left font-medium",children:"Phone"}),e.jsx("th",{className:"px-6 py-3 text-left font-medium",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left font-medium",children:"Actions"})]})}),e.jsx("tbody",{className:"",children:N.map(t=>e.jsxs("tr",{className:"border-b border-slate-600 bg-[#282a2c] transition duration-300 ",children:[e.jsx("td",{className:"px-6 py-4 text-white",children:e.jsx($,{src:t.workerImage,className:" rounded-lg",width:70,height:100})}),e.jsx("td",{className:"px-6 py-4 text-white",children:t.workerName}),e.jsx("td",{className:"px-6 py-4 text-white",children:t.phoneNumber}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-white text-sm ${t.status===!0?"bg-green-500":"bg-[#d65f63] hover:bg-[#e94560]"}`,children:t.status===!0?"Active":"Blocked"})}),e.jsx("td",{className:"px-6 py-4  gap-2",children:e.jsx("button",{className:"px-4 py-2 bg-[#3890d8] text-white text-sm font-semibold rounded-md transition duration-300 hover:bg-blue-500",onClick:()=>D(t._id),children:t.status===!0?"De-activate":"Activate"})})]},t._id))})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 bg-[#282a2c]",children:[e.jsx("button",{onClick:()=>x(t=>Math.max(t-1,1)),className:`px-4 py-2 bg-[#3890d8] text-white rounded-md transition duration-300 hover:bg-[#14c8c8] ${a===1?"opacity-50 cursor-not-allowed":""}`,disabled:a===1,children:"Previous"}),e.jsxs("span",{className:"text-white",children:["Page ",a," of ",i]}),e.jsx("button",{onClick:()=>x(t=>Math.min(t+1,i)),className:`px-4 py-2 bg-[#3890d8] text-white rounded-md transition duration-300 hover:bg-[#14c8c8] ${a===i?"opacity-50 cursor-not-allowed":""}`,disabled:a===i,children:"Next"})]})]})]})})};export{U as default};
